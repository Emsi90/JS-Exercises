var carusel = document.getElementsByClassName('carusel');


[].forEach.call(carusel, function(c) {
   
    var prev = c.querySelector('.carusel__prev');
    var next = c.querySelector('.carusel__next');
    var bubbles = c.getElementsByClassName('carusel__bubbles')[0];
    var testimonials = c.querySelector('.carusel__testimonials');
    var testimonial = c.getElementsByClassName('carusel__testimonial');
    console.log(testimonial.length);
    
    var currentImageIndex = 0;
    var width = 600;
    var arrBubbles = [];
    
    for(var i = 0; i < testimonial.length; i++) {
        
        var b = document.createElement('span');
        b.classList.add('carusel__bubble');
        bubbles.appendChild(b);
        arrBubbles.push(b);
        console.log(i);
        
//        b.addEventListener('click', function(){
//            
//            currentImageIndex = i;
//            console.log(i);
//            switchImg();
//            
//        }, false);
        
        arrBubbles.forEach(function(b, i){
            
            b.addEventListener('click', function() {
               
                currentImageIndex = i;
                switchImg();
                
            });
            
        }, false);
        
    }
    
    function switchImg() {
        
        testimonials.style.left = -width * currentImageIndex + 'px';
        
        arrBubbles.forEach(function(b, i) {
           
           if(i === currentImageIndex) {
               b.classList.add('carusel__bubble--active');
           } else {
               b.classList.remove('carusel__bubble--active');
           }
            
        });
    }
    
    prev.addEventListener('click', function() {
        
        currentImageIndex--;
        
        if(currentImageIndex < 0) {
            
            currentImageIndex = testimonial.length - 1;
            
        }
        console.log(testimonial.length);
        switchImg();
        
    }, false);
    
    next.addEventListener('click', function() {
        
        currentImageIndex++;
        
        if(currentImageIndex >= testimonial.length) {
            
            currentImageIndex = 0;
            
        }
        
        switchImg();
        
    }, false);
    
    switchImg();
});